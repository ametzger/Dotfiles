# -*- shell-script -*-
#!/usr/bin/env zsh

echo 'Setting up Emacs...'

# Should be in Brewfile
# brew install emacs --with-cocoa --with-librsvg --with-imagemagick@6 --with-mailutils

if [ ! -d '~/proj/vendor' ]; then
    echo 'Creating ~/proj/vendor directory...'
    mkdir -p ~/proj/vendor
fi

# Uncomment to use Prelude
# if [ ! -d '~/proj/vendor/prelude' ]; then
#     echo 'Cloning Prelude to ~/proj/vendor/prelude'
#     git clone https://github.com/bbatsov/prelude.git ~/proj/vendor/prelude
# fi

# pushd ~/proj/vendor/prelude

# rm -rf personal
# ln -sf ~/proj/dotfiles/emacs/personal ~/proj/vendor/prelude/personal
# if [ -f ~/prelude-modules.el ]; then
#     rm -f ~/prelude-modules.el
# fi
# ln -sf ~/proj/dotfiles/emacs/prelude-modules.el ~/proj/vendor/prelude/prelude-modules.el

# Install Spacemacs
if [ ! -d '~/proj/vendor/spacemacs' ]; then
    echo 'Cloning Spacemacs to ~/proj/vendor/spacemacs'
    git clone https://github.com/syl20bnr/spacemacs ~/proj/vendor/spacemacs
fi

if [ -d ~/.emacs.d ]; then
    echo 'Backing up existing emacs config to ~/.emacs.d.bak'
    mv ~/.emacs.d ~/.emacs.d.bak
fi

ln -sf ~/proj/vendor/spacemacs ~/.emacs.d

echo 'Done!'
